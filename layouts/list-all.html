{{ define "main" }}
<main class="main">
  <header class="page-header">
    <h1>{{ .Title }}</h1>
    {{ with .Content }}
      <div class="page-description">{{ . }}</div>
    {{ end }}
  </header>

  {{- $pages := site.RegularPages.ByDate.Reverse -}}

  <div class="archive">
    {{- range $pages.GroupByDate "2006" -}}
      <h3 class="archive-year">{{ .Key }}</h3>

      <div class="archive-list">
        {{- range .Pages -}}
          {{- /* 優化摘要抓取：優先使用設定的描述，最後才用純文字擷取 */ -}}
          {{- $excerpt := "" -}}
          {{- if .Description -}}
            {{- $excerpt = .Description -}}
          {{- else if .Summary -}}
            {{- $excerpt = .Summary -}}
          {{- else -}}
            {{- $excerpt = .Plain | truncate 60 -}}
          {{- end -}}

          <div class="archive-item">
            <span class="archive-date">{{ .Date.Format "01/02" }}</span>

            <a class="archive-title" href="{{ .RelPermalink }}">
              {{ .Title }}
            </a>

            <span class="archive-excerpt">
              {{- $excerpt | plainify -}}
            </span>
          </div>
        {{- end -}}
      </div>
    {{- end -}}
  </div>
</main>
{{ end }}